<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Project Snowball</title>
	
	<link rel="stylesheet" type="text/css" href="css/theme.css">
	
  <script type="text/javascript" src="javascript/Post.js"></script>
	<script type="text/javascript" src="javascript/mouse.js"></script>
	<script type="text/javascript" src="javascript/gamestates.js"></script>
	<script type="text/javascript" src="javascript/menuObjects.js"></script>
	<script type="text/javascript" src="javascript/gameObjects.js"></script>
	
	<script type="text/javascript" src="javascript/randomObjects.js"></script>
	<script type="text/javascript" src="javascript/RandomFunctions.js"></script>
	<script type="text/javascript" src="javascript/devFunctions.js"></script>
	<script type="text/javascript" src="javascript/howler.js/dist/howler.min.js"></script>
	<script type="text/javascript" src="javascript/Sound/Music.js"></script>
	<script type="text/javascript" src="javascript/Sound/Sound.js"></script>
</head>
<body>
<div class="wrapper">
	<div id="banner">
		<h1 id="title">Snowball</h1>
	</div>
	
	<canvas id='canvas' width='800' height='600'></canvas>
	
	<div class="push"></div>
</div>

	<div id="footer">
		<div class="container">
			<ul>
				<li>Created By: Wolf Pack</li>
				<li>Last Updated 14 June 2016</li>
				<li>Source Code at <a href="https://github.com/tabenmalik/Project-Snowball">github.com</a></li>
			</ul>
		</div>
	</div>
	
	<script type='text/javascript'>
	window.onkeydown = function(e) {
		if(e.keyCode == 32 && e.target == document.body) {
			e.preventDefault();
			return false;
		}
	};
	
	document.getElementById('canvas').onmousedown = function(){
		mouse.clicked = true;
		return false;
	};
	document.getElementById('canvas').onmouseup = function(){
		mouse.clicked = false;
	};
	

	//Global Variables
	var can = document.getElementById('canvas');
	var ctx = can.getContext("2d");
	var mouse = 0;
	var gamestate = new Gamestates();
	var UPDATEINTERVAL = (1000/60);
	var accumulate = 0;
	var lastTickTime = 0;
  var gameMusic = new Music();
 
	var player = new Player(0,0,10,0);
	var keys = {
		w: false,
		a: false,
		s: false,
		d: false,
		space: false,
		p: false,
	};
	var images = {
		Post: new Image(),
		Sleigh: new Image(),
		Enemy: new Image(),
		Money: new Image(),
		House: new Image(),
	};

	
	function main(){
		images.Post.src = "images/Post.png";
		images.Sleigh.src = "images/Sleigh.png";
		images.Enemy.src = "images/Enemy.png";
		images.Money.src = "images/Money.png";
		images.House.src = "images/House.png";
		mouse = new Mouse();
		mouse.setup();
		
		gamestate.setup();
    gamestate.changeGameState("mainMenu");
		can.onmousemove = function(){mouse.setMousePosition(event);};
		document.addEventListener('keydown', handleKeyDown);
		document.addEventListener('keyup', handleKeyUp);
		window.requestAnimationFrame(tick);
	}
	
	function handleClick(event){
		mouse.clicked = true;
	}
	
	
	var tick = function(time){
		var deltaTime = time - lastTickTime;
		
		ctx.beginPath();
		gamestate.draw();
		
		accumulate += deltaTime;
		
		while(accumulate >= UPDATEINTERVAL){
			gamestate.update(UPDATEINTERVAL);
			accumulate -= UPDATEINTERVAL;
		}
		
		lastTickTime = time;
		window.requestAnimationFrame(tick);
	};
	
	main();
	
	</script>
</html>
